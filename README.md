# TDD-Practice

### 1. 단위 테스트의 중요성과 좋은 단위 테스트의 특징

#### [ 단위 테스트(Unit Test)를 작성해야 하는 이유 ]
- 코드를 수정하거나 기능을 추가할 때 수시로 빠르게 검증 할 수 있다.
- 리팩토링 시에 안정성을 확보할 수 있다.
- 개발 및 테스팅에 대한 시간과 비용을 절감할 수 있다.

#### [ 좋은 테스트의 특징, FIRST라는 5가지 규칙 ]
- <b>Fast</b>: 테스트는 빠르게 동작하여 자주 돌릴 수 있어야 한다.
- <b>Independent</b>: 각각의 테스트는 독립적이며 서로 의존해서는 안된다.
- <b>Repeatable</b>: 어느 환경에서도 반복 가능해야 한다.
- <b>Self-Validating</b>: 테스트는 성공 또는 실패로 bool 값으로 결과를 내어 자체적으로 검증되어야 한다.
- <b>Timely</b>: 테스트는 적시에 즉, 테스트하려는 실제 코드를 구현하기 직전에 구현해야 한다.

<br>

### 2. TDD(테스트 주도 개발), 테스트 코드를 먼저 작성해야 하는 이유와 방법 및 순서

#### [ 테스트 코드를 먼저 작성해야 하는 이유 ]
- 깔끔한 코드를 작성할 수 있다.
- 장기적으로 개발 비용을 절감할 수 있다.
- 개발이 끝나면 테스트 코드를 작성하는 것은 매우 귀찮다. 실패 케이스면 더욱 그렇다.

#### [ TDD(Test-Driven Development, 테스트 주도 개발) 방법 및 순서 ]
1. 실패하는 작은 단위 테스트를 작성한다. 처음에는 컴파일조차 되지 않을 수 있다.
2. 빨리 테스트를 통과하기 위해 프로덕션 코드를 작성한다. 이를 위해 정답이 아닌 가짜 구현 등을 작성할 수도 있다.
3. 그 다음의 테스트 코드를 작성한다. 실패 테스트가 없을 경우에만 성공 테스트를 작성한다.
4. 새로운 테스트를 통과하기 위해 프로덕션 코드를 추가 또는 수정한다.
5. 1~4단계를 반복하여 실패/성공의 모든 테스트 케이스를 작성한다.
6. 개발된 코드들에 대해 모든 중복을 제거하며 리팩토링한다.

#### [ TDD(Test-Driven Development, 테스트 주도 개발) 접근 방법 ]
- 가짜로 구현하기: 최대한 빨리 테스트를 통과하기 위해 정답이 아닌 가짜 정답을 구현하는 방법
- 삼각측량법: 값이 다른 여러 테스트를 작성하고, 이를 일반화하여 정답을 구현하는 방법
- 명백하게 구현하기: 정답을 바로 구현하는 방법


#### [ Spring에서의 TDD(Test-Driven Development, 테스트 주도 개발) 프로그래밍 방법 ]

- Repository -> Service -> Controller 순서로 개발을 진행한다.
    - Repository 계층은 다른 계층에 대한 의존성이 거의 없기 때문에 먼저 작성하기가 편리하기 때문
- Repository 계층의 테스트는 H2와 같은 인메모리 데이터베이스 기반의 통합 테스트로 진행한다.
- Service 계층의 테스트는 Mockito를 사용해 Repository 계층을 Mock하여 진행한다.
- Controller 계층의 테스트는 SpringTest의 MockMvc를 사용해 진행한다.

<br>

### 3. TDD 연습문제 소개와 요구사항 분석

#### [ 문제 설명 ]

- 이번 연습 문제의 주제는 멤버십 적립 서비스입니다.
- 현재 지원중인 멤버십에는 네이버, 카카오, 라인 3가지 멤버십이 있으며, 사용자는 원하는 멤버십을 등록할 수 있습니다.
- 포인트 적립비율은 결제금액의 1%로 고정되며, 추후에 고정 금액(1000원)으로 확장하여 적립될 수 있어야 합니다.
- 이번 연습문제에서는 위의 문제 설명과 아래의 요구사항을 만족하는 REST API를 자유롭게 정의하고, TDD 방식으로 구현하는 것입니다.

 
#### [ 기능 요구 사항 ]

- 멤버십 연결하기, 나의 멤버십 조회, 멤버십 연결끊기, 포인트 적립 API 를 구현합니다.
- 사용자 식별값은 문자열 형태이며 "X-USER-ID" 라는 HTTP Header 로 전달되며, 이 값은 포인트 적립할 때 바코드 대신 사용됩니다.
- Content-type 응답 형태는 application/json(JSON) 형식을 사용합니다.
- 각 기능 및 제약사항에 대한 개발을 TDD, 단위테스트를 기반으로 진행해야 합니다.

 
#### [ 상세 기술 구현 사항 ]

- 나의 멤버십 등록 API
    - 기능: 나의 멤버십을 등록합니다.
    - 요청: 사용자 식별값, 멤버십 이름, 포인트
    - 응답: 멤버십 ID, 멤버십 이름


- 나의 멤버십 전체 조회 API
    - 기능: 내가 가진 모든 멤버십을 조회합니다.
    - 요청: 사용자 식별값
    - 응답: {멤버십 ID, 멤버십 이름, 포인트, 가입 일시}의 멤버십 리스트


- 나의 멤버십 상세 조회 API
    - 기능: 나의 1개 멤버십을 상세 조회합니다.
    - 요청: 사용자 식별값, 멤버십 ID
    - 응답: 멤버십 ID, 멤버십 이름, 포인트, 가입일시


- 나의 멤버십 삭제 API
    - 기능: 나의 멤버십을 삭제합니다.
    - 요청: 사용자 식별값, 멤버십 번호
    - 응답: X


- 멤버십 포인트 적립 API
    - 기능: 나의 멤버십 포인트를 결제 금액의 1%만큼 적립합니다.
    - 요청: 사용자 식별값, 멤버십 ID, 사용 금액을 입력값으로 받습니다.
    - 응답: X


<br>

#### [ 기술 요구 사항 ]

- Java 8
- Spring Boot 2.7.17
- JPA
- Mysql / H2

<br>

출처: https://mangkyu.tistory.com/182 [MangKyu's Diary:티스토리]